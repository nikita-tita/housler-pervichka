# Housler Pervichka ‚Äî –ó–∞–¥–∞—á–∏

## –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –°–¥–µ–ª–∞–Ω–æ (–≠—Ç–∞–ø 0 + —á–∞—Å—Ç–∏—á–Ω–æ –≠—Ç–∞–ø 1)

**Backend:**
- [x] –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- [x] Docker Compose (PostgreSQL + Redis)
- [x] –ü–∞—Ä—Å–µ—Ä XML-—Ñ–∏–¥–∞ (`yandex-feed.parser.ts`)
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î (`001_init.sql`)
- [x] –ò–º–ø–æ—Ä—Ç-—Å–µ—Ä–≤–∏—Å (`import.service.ts`)
- [x] CLI –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ (`import-feed.ts`)
- [x] –°–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞ (`offers.service.ts`)
- [x] API: GET /api/offers, GET /api/offers/:id, GET /api/filters
- [x] –≠–≤—Ä–∏—Å—Ç–∏–∫–∞ –µ–≤—Ä–æ-–ø–ª–∞–Ω–∏—Ä–æ–≤–æ–∫ (`euro-detector.ts`)

**Frontend:**
- [x] Next.js + Tailwind
- [x] –î–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º–∞ housler.ru (globals.css)
- [x] Layout —Å Header/Footer
- [x] –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –±—ã—Å—Ç—Ä—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- [x] –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞ /offers
- [x] –ö–∞—Ä—Ç–æ—á–∫–∞ –æ–±—ä–µ–∫—Ç–∞ /offers/[id]
- [x] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç OfferCard
- [x] –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Filters
- [x] API-—Å–µ—Ä–≤–∏—Å

---

## üî¥ MVP (–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞)

### 1. –ó–∞–≤–µ—Ä—à–∏—Ç—å Backend API
- [ ] **1.1** –ü–æ–∏—Å–∫ –ñ–ö ‚Äî GET /api/complexes
- [ ] **1.2** –î–µ—Ç–∞–ª–∏ –ñ–ö ‚Äî GET /api/complexes/:id
- [ ] **1.3** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ ‚Äî GET /api/dictionaries/:type (districts, metro, renovations)
- [ ] **1.4** –°—á—ë—Ç—á–∏–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ‚Äî GET /api/offers/count (–±—ã—Å—Ç—Ä—ã–π –ø–æ–¥—Å—á—ë—Ç)

### 2. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- [ ] **2.1** –ú–æ–¥–µ–ª—å User (email, role: agent/client/operator)
- [ ] **2.2** POST /api/auth/request-code ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –Ω–∞ email
- [ ] **2.3** POST /api/auth/verify-code ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞, –≤—ã–¥–∞—á–∞ JWT
- [ ] **2.4** Middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- [ ] **2.5** Frontend: —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞, –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### 3. –ü–æ–¥–±–æ—Ä–∫–∏ –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤
- [ ] **3.1** –ú–æ–¥–µ–ª—å Selection (name, agent_id, client_email, share_code)
- [ ] **3.2** –ú–æ–¥–µ–ª—å SelectionItem (selection_id, offer_id, comment)
- [ ] **3.3** POST /api/selections ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥–±–æ—Ä–∫—É
- [ ] **3.4** POST /api/selections/:id/items ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç
- [ ] **3.5** GET /api/selections/shared/:code ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ —Å—Å—ã–ª–∫–µ (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
- [ ] **3.6** Frontend: —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–±–æ—Ä–∫–∏, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞

### 4. –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
- [ ] **4.1** –ú–æ–¥–µ–ª—å Favorite (user_id, offer_id)
- [ ] **4.2** POST /api/favorites ‚Äî –¥–æ–±–∞–≤–∏—Ç—å
- [ ] **4.3** DELETE /api/favorites/:offerId ‚Äî —É–¥–∞–ª–∏—Ç—å
- [ ] **4.4** GET /api/favorites ‚Äî —Å–ø–∏—Å–æ–∫
- [ ] **4.5** Frontend: –∫–Ω–æ–ø–∫–∞ ‚ù§Ô∏è –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ, —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

### 5. –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] **5.1** –ú–æ–¥–µ–ª—å Booking (offer_id, agent_id, client_*, status)
- [ ] **5.2** POST /api/bookings ‚Äî —Å–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
- [ ] **5.3** GET /api/operator/bookings ‚Äî —Å–ø–∏—Å–æ–∫ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
- [ ] **5.4** PATCH /api/operator/bookings/:id ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
- [ ] **5.5** Frontend: —Ñ–æ—Ä–º–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞

### 6. Cron-–∑–∞–¥–∞—á–∏
- [ ] **6.1** –ò–º–ø–æ—Ä—Ç —Ñ–∏–¥–∞ –∫–∞–∂–¥—ã–µ 4 —á–∞—Å–∞
- [ ] **6.2** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤ complexes
- [ ] **6.3** –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç—ë–∫—à–∏—Ö –∫–æ–¥–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### 7. Frontend ‚Äî –¥–æ—Ä–∞–±–æ—Ç–∫–∏
- [ ] **7.1** –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ñ–ö ‚Äî /complexes/:id
- [ ] **7.2** –°–ø–∏—Å–æ–∫ –ñ–ö ‚Äî /complexes
- [ ] **7.3** –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é (—Ä–∞–±–æ—Ç–∞—é—â–µ–µ)
- [ ] **7.4** –ò–ø–æ—Ç–µ—á–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä (–ø—Ä–æ—Å—Ç–æ–π)
- [ ] **7.5** –ö–∞—Ä—Ç–∞ Yandex Maps (embed –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –æ–±—ä–µ–∫—Ç–∞)
- [ ] **7.6** –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ URL

---

## üü° –í–∞–∂–Ω–æ (–ø–æ—Å–ª–µ MVP)

### 8. –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞
- [ ] **8.1** –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –ñ–ö
- [ ] **8.2** –ü–æ–¥—Å–∫–∞–∑–∫–∏ –≤ —Å—Ç—Ä–æ–∫–µ –ø–æ–∏—Å–∫–∞ (–ñ–ö, —Ä–∞–π–æ–Ω—ã, –º–µ—Ç—Ä–æ)
- [ ] **8.3** –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø–æ–∏—Å–∫–∏
- [ ] **8.4** –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (—Ü–µ–Ω–∞, –ø–ª–æ—â–∞–¥—å, –¥–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)

### 9. –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
- [ ] **9.1** –¢–∞–±–ª–∏—Ü–∞ price_history (offer_id, price, recorded_at)
- [ ] **9.2** –¢—Ä–∏–≥–≥–µ—Ä –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
- [ ] **9.3** –ì—Ä–∞—Ñ–∏–∫ —Ü–µ–Ω—ã –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –æ–±—ä–µ–∫—Ç–∞

### 10. –ö–∞—Ä—Ç–∞
- [ ] **10.1** –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–µ–π
- [ ] **10.2** –ü–æ–∏—Å–∫ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –Ω–∞ –∫–∞—Ä—Ç–µ
- [ ] **10.3** –ú–∞—Ä—à—Ä—É—Ç –¥–æ –º–µ—Ç—Ä–æ

---

## üü¢ –£–ª—É—á—à–µ–Ω–∏—è (–≠—Ç–∞–ø 2+)

### 11. Yandex GPT
- [ ] **11.1** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å API
- [ ] **11.2** –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ: —Ç–∏–ø —Å–¥–µ–ª–∫–∏, —ç—Å–∫—Ä–æ—É, –∞–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç—ã
- [ ] **11.3** –§–∏–ª—å—Ç—Ä—ã –ø–æ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- [ ] **11.4** AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–æ–∏—Å–∫–∞ (NLP)

### 12. –í–Ω–µ—à–Ω–∏–µ API
- [ ] **12.1** –†–µ–≥–∏–æ–Ω –ø—Ä–æ–ø–∏—Å–∫–∏ (–≥–µ–æ–∫–æ–¥–µ—Ä)
- [ ] **12.2** –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –∫–ª—é—á–µ–≤–∞—è —Å—Ç–∞–≤–∫–∞ –¶–ë
- [ ] **12.3** DaData –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏ –∞–¥—Ä–µ—Å–æ–≤

### 13. –†—É—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- [ ] **13.1** –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –±–∞–Ω–∫–æ–≤
- [ ] **13.2** –ò–ø–æ—Ç–µ—á–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
- [ ] **13.3** –ê–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏–∏ –ñ–ö
- [ ] **13.4** –†–∞—Å—Å—Ä–æ—á–∫–∞ –æ—Ç –∑–∞—Å—Ç—Ä–æ–π—â–∏–∫–æ–≤
- [ ] **13.5** –ê–∫—Ü–∏–∏
- [ ] **13.6** –ê–¥–º–∏–Ω–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞

---

## –ü–æ—Ä—è–¥–æ–∫ —Ä–∞–±–æ—Ç—ã

```
–ù–µ–¥–µ–ª—è 1: –ó–∞–¥–∞—á–∏ 1-2 (API + –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
–ù–µ–¥–µ–ª—è 2: –ó–∞–¥–∞—á–∏ 3-5 (–ü–æ–¥–±–æ—Ä–∫–∏, –ò–∑–±—Ä–∞–Ω–Ω–æ–µ, –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
–ù–µ–¥–µ–ª—è 3: –ó–∞–¥–∞—á–∏ 6-7 (Cron + Frontend –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
–ù–µ–¥–µ–ª—è 4: –ó–∞–¥–∞—á–∏ 8-10 (–£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞, –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω, –ö–∞—Ä—Ç–∞)
```

---

## –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ–≥–æ —Å—Ç–µ–∫–∞
docker-compose up -d

# Backend (dev)
cd backend && npm run dev

# Frontend (dev)
cd frontend && npm run dev

# –ò–º–ø–æ—Ä—Ç —Ñ–∏–¥–∞
cd backend && npm run import:feed -- --file=./feeds/spb_.xml --migrate

# –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
cd backend && npm run db:migrate
```
